/* ============================================================================
   CLOCKWORKS PRODUCTION SITE — MAIN CSS (REFACTORED)
   Version: 4.3.0
   Author: Clockworks Production & Gemini
   License: MIT
   Notes: A unified, token-based, and component-driven CSS architecture
          with a complete, theme-aware, professional font system.
          (Definitive navbar overflow and z-index fix)
============================================================================ */

/* ============================================================================
   1. IMPORTS
============================================================================ */

/* FontAwesome for Icons */
@import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css');

/* W3.CSS Framework (Base) */
@import url('https://www.w3schools.com/w3css/5/w3.css');

/* Google Fonts - Full Font System */
@import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Cinzel+Decorative&family=Cormorant+Garamond:wght@400;600;700&family=EB+Garamond&family=Fira+Code&family=IBM+Plex+Sans&family=Inter:wght@400;500;600&family=Roboto+Condensed:wght@400;700&family=Roboto+Slab&family=Source+Code+Pro&family=Source+Sans+Pro:wght@400;600&family=Spectral&display=swap');

/* ============================================================================
   2. DESIGN TOKENS (CSS VARIABLES)
============================================================================ */

/* -------------------------------------------------------------
   LIGHT THEME (DEFAULT) — INDUSTRIAL / STEAMPUNK
------------------------------------------------------------- */
:root {
    /* ---- Core Palette ---- */
    --cw-bg: #f5f3ef;
    --cw-bg-alt: #ebe7e2;
    --cw-surface: #ffffff;
    --cw-surface-alt: #f0ece6;
    --cw-text: #2a2a2a;
    --cw-text-dim: #5c5c5c;

    /* ---- Industrial Metals ---- */
    --cw-accent: #c89f43; /* Brass */
    --cw-accent-alt: #b06c3a; /* Copper */

    /* ---- Shadows & Shape ---- */
    --cw-radius: 12px;
    --cw-shadow-1: 0 4px 12px rgba(0,0,0,0.07);
    --cw-shadow-2: 0 8px 18px rgba(0,0,0,0.1);
    --cw-transition: 0.4s ease;

    /* ---- Theme Switcher ---- */
    --cw-switch-bg: #ccc;
    --cw-switch-knob-bg: white;

    /* ---- FONT SYSTEM: LIGHT THEME ---- */
    --font-h1: 'Cormorant Garamond', system-ui, serif;
    --font-h2: 'Roboto Slab', system-ui, serif;
    --font-h3: 'Cormorant Garamond', Arial, serif;
    --font-h4: 'Roboto Condensed', 'Segoe UI', sans-serif;
    --font-h5: 'Source Sans Pro', 'Roboto', sans-serif;
    --font-h6: 'Source Sans Pro', 'Roboto', sans-serif;
    --font-p: 'Source Sans Pro', system-ui, sans-serif;
    --font-list: 'Roboto Condensed', Arial, sans-serif;
    --font-table: 'IBM Plex Sans', 'Segoe UI', sans-serif;
    --font-mermaid: 'Source Code Pro', monospace;
    --font-card-h1: 'Cormorant Garamond', system-ui, serif;
    --font-card-h2: 'Cormorant Garamond', system-ui, serif;
    --font-card-h3: 'Roboto Slab', system-ui, serif;
    --font-card-h4: 'Source Sans Pro', 'Segoe UI', sans-serif;
    --font-card-h5: 'Roboto Condensed', 'Roboto', sans-serif;
    --font-card-h6: 'Source Sans Pro', 'Roboto', sans-serif;
    --font-card-p: 'Source Sans Pro', system-ui, sans-serif;
    --font-nav: 'Roboto Condensed', 'Segoe UI', sans-serif;
    --font-footer: 'Roboto Slab', Arial, serif;
}

/* -------------------------------------------------------------
   DARK THEME OVERRIDES — MYSTIC / ARCANE
------------------------------------------------------------- */
[data-theme="dark"] {
    /* ---- Core Palette ---- */
    --cw-bg: #0d0b12;
    --cw-bg-alt: #16141d;
    --cw-surface: #191721;
    --cw-surface-alt: #221f2c;
    --cw-text: #e3def7;
    --cw-text-dim: #b8b4d4;
    --cw-accent: #9f5cff; /* Arcane Core */
    --cw-accent-alt: #53ffe6; /* Arcane Flare */
    --cw-shadow-1: 0 0 18px rgba(159, 92, 255, 0.15);
    --cw-shadow-2: 0 0 30px rgba(83, 255, 230, 0.2);
    --cw-switch-bg: var(--cw-accent-alt);
    --cw-switch-knob-bg: var(--cw-bg-alt);

    /* ---- FONT SYSTEM: DARK THEME ---- */
    --font-h1: 'Cinzel Decorative', system-ui, serif;
    --font-h2: 'Cinzel', system-ui, serif;
    --font-h3: 'EB Garamond', Arial, serif;
    --font-h4: 'Spectral', 'Segoe UI', serif;
    --font-h5: 'Inter', 'Roboto', sans-serif;
    --font-h6: 'Inter', 'Roboto', sans-serif;
    --font-p: 'Inter', system-ui, sans-serif;
    --font-list: 'Spectral', Arial, serif;
    --font-mermaid: 'Fira Code', monospace;
    --font-card-h1: 'Cinzel Decorative', system-ui, serif;
    --font-card-h2: 'Cinzel', system-ui, serif;
    --font-card-h3: 'Spectral', system-ui, serif;
    --font-card-h4: 'EB Garamond', 'Segoe UI', serif;
    --font-card-h5: 'Inter', 'Roboto', sans-serif;
    --font-card-h6: 'Inter', 'Roboto', sans-serif;
    --font-card-p: 'Inter', system-ui, sans-serif;
    --font-nav: 'Cinzel', 'Segoe UI', sans-serif;
    --font-footer: 'Spectral', Arial, serif;
}

/* ============================================================================
   3. BASE & TYPOGRAPHY
============================================================================ */

html { box-sizing: border-box; font-size: 15px; line-height: 1.5; overflow-x: hidden; }
*, *::before, *::after { box-sizing: inherit; margin: 0; padding: 0; }

body {
    background-color: var(--cw-bg);
    color: var(--cw-text);
    font-family: var(--font-p);
    transition: background-color var(--cw-transition), color var(--cw-transition);
}

h1, .w3-h1 { font-family: var(--font-h1); font-weight: 700; font-size: 2.4rem; }
h2, .w3-h2 { font-family: var(--font-h2); font-weight: 600; font-size: 2.0rem; }
h3, .w3-h3 { font-family: var(--font-h3); font-weight: 500; font-size: 1.6rem; }
h4, .w3-h4 { font-family: var(--font-h4); font-weight: 500; }
h5, .w3-h5 { font-family: var(--font-h5); font-weight: 600; }
h6, .w3-h6 { font-family: var(--font-h6); font-weight: 500; }
p { font-family: var(--font-p); }
ul, ol { font-family: var(--font-list); }
table { font-family: var(--font-table); }
.mermaid { font-family: var(--font-mermaid) !important; }

a { color: var(--cw-accent); text-decoration: none; transition: color var(--cw-transition); }
a:hover { color: var(--cw-accent-alt); }

/* ============================================================================
   4. COMPONENTS
============================================================================ */

/* --- Navbar --- */
.nav .w3-bar {
    overflow: visible !important; /* DEFINITIVE FIX: Force overflow to be visible */
}

.w3-dropdown-content {
    z-index: 99 !important; /* DEFINITIVE FIX: Ensure dropdown appears on top of all other content */
}

.nav {
    font-family: var(--font-nav);
    font-weight: 700;
    background-color: var(--cw-surface-alt) !important;
    border-bottom: 2px solid var(--cw-accent);
    box-shadow: var(--cw-shadow-1);
}
[data-theme="dark"] .nav { font-weight: 300; }

/* --- Sidebar --- */
#mySidebar {
    background-color: var(--cw-surface) !important;
    border-right: 2px solid var(--cw-accent);
    box-shadow: var(--cw-shadow-2);
}

/* --- Cards --- */
.w3-card, .w3-card-4 {
    background-color: var(--cw-surface);
    box-shadow: var(--cw-shadow-1);
    border-radius: var(--cw-radius);
    border: 1px solid var(--cw-accent);
    transition: all var(--cw-transition);
}
.w3-card:hover, .w3-card-4:hover {
    box-shadow: var(--cw-shadow-2);
    transform: translateY(-2px);
}
.w3-card h1 { font-family: var(--font-card-h1); }
.w3-card h2 { font-family: var(--font-card-h2); }
.w3-card h3 { font-family: var(--font-card-h3); }
.w3-card h4 { font-family: var(--font-card-h4); }
.w3-card h5 { font-family: var(--font-card-h5); }
.w3-card h6 { font-family: var(--font-card-h6); }
.w3-card p  { font-family: var(--font-card-p); }

/* --- Footer --- */
.footer {
    font-family: var(--font-footer);
    background-color: var(--cw-surface-alt);
    border-top: 2px solid var(--cw-accent);
    padding: 24px;
}

/* --- Theme Toggle Switch --- */
.switch { position: relative; display: inline-block; width: 60px; height: 34px; }
.switch input { opacity: 0; width: 0; height: 0; }
.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--cw-switch-bg); transition: var(--cw-transition); display: flex; align-items: center; justify-content: space-between; padding: 0 8px; }
.slider:before { position: absolute; content: ""; height: 26px; width: 26px; left: 4px; bottom: 4px; background-color: var(--cw-switch-knob-bg); transition: var(--cw-transition); z-index: 1; }
input:checked + .slider { background-color: var(--cw-accent); }
input:checked + .slider:before { transform: translateX(26px); }
.slider.round { border-radius: 34px; }
.slider.round:before { border-radius: 50%; }
.slider .fa-magic-wand-sparkles, .slider .fa-gears { position: relative; transition: all var(--cw-transition); z-index: 1; }
.slider .fa-magic-wand-sparkles { color: purple; opacity: 1; }
.slider .fa-gears { color: gold; opacity: 0; }
input:checked + .slider .fa-magic-wand-sparkles { opacity: 0; transform: rotate(-90deg); }
input:checked + .slider .fa-gears { opacity: 1; transform: rotate(0); }

/* ============================================================================
   5. ANIMATIONS & EFFECTS
============================================================================ */

body::before {
    content: "";
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: -1;
    background-repeat: repeat;
    background-size: contain;
    opacity: 0.1;
    transition: all 0.8s ease-in-out;
}

[data-theme="dark"] body::before { animation: darkParticleParallax 180s linear infinite, glowDark 4s ease-in-out infinite alternate; }
[data-theme="light"] body::before { animation: lightParticleParallax 120s linear infinite, glowLight 3s ease-in-out infinite alternate; }

@keyframes darkParticleParallax { 0% { transform: translate(0,0) rotate(0deg); } 100% { transform: translate(10px, 20px) rotate(60deg); } }
@keyframes glowDark { from { opacity: 0.08; filter: drop-shadow(0 0 2px var(--cw-accent-alt)); } to { opacity: 0.12; filter: drop-shadow(0 0 6px var(--cw-accent)); } }
@keyframes lightParticleParallax { 0% { transform: translate(0,0) rotate(0deg); } 100% { transform: translate(20px, 10px) rotate(120deg); } }
@keyframes glowLight { from { opacity: 0.08; filter: drop-shadow(0 0 2px var(--cw-accent-alt)); } to { opacity: 0.12; filter: drop-shadow(0 0 6px var(--cw-accent)); } }
